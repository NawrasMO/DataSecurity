<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script  src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script>

    async function print() {
        let printer = $("#selectPrinter").val()
        let file = $("#fileName").val()
        console.log(printer)
        let data=""
        try {
            const url = '/print?printer='+printer+'&file='+file
            console.log(url)
            const response = await fetch(url);

            if (!response.ok) {

                $("#printStatus").html("Error")

            }
            const  tex= await response.text()
            console.log(tex)
            $("#logDiv").html(tex.replace(/\n/g, '<br>'))


        } catch (error) {
            $("#printStatus").html("error")

        }
    }
async function startServer() {
        try {
        const url = '/startServer';
        const response = await fetch(url);
        console.log(response)
        if (!response.ok) {
            throw new Error('Network response was not OK');
        }

        const data = await response.json();
        console.log(data["data"]);
        window.location.href="/home"
    } catch (error) {
    }
}
async function stopServer() {
    try {
        const url = '/stopServer';
        const response = await fetch(url);
        console.log(response)
        if (!response.ok) {
            throw new Error('Network response was not OK');
        }

        const data = await response.json();
        console.log(data["data"]);
        window.location.href = "/home"
    } catch (error) {
        console.error('Fetch error:', error);
    }

}

    async function restartServer() {
        try {
            const url = '/restartServer';
            const response = await fetch(url);
            console.log(response)
            if (!response.ok) {
                throw new Error('Network response was not OK');
            }

            const data = await response.json();
            console.log(data["data"]);
            window.location.href = "/home"
        } catch (error) {
            console.error('Fetch error:', error);
        }

    }

async function queue() {
    let printer = $("#selectPrinter2").val()
    try {
        const url = `/queue?printer=${printer}`;
        const response = await fetch(url);
        console.log(response)
        if (!response.ok) {

            $("#queuePrinter").html("Printer" + $("#selectPrinter2").val() + "is not avalable")

        }
        const  tex= await response.text()
        console.log(tex)
        $("#logDiv").html(tex.replace(/\n/g, '<br>'))

    } catch (error) {
        console.error('Fetch error:', error);
    }
}

    async function topQueue() {
        let printer = $("#selectPrinter3").val()
        let job = $("#jobid").val()
        try {
            const url = `/topQueue?printer=${printer}&job=${job}`;
            const response = await fetch(url);
            console.log(response)
            if (!response.ok) {

                $("#topqueue").html("Printer" + $("#selectPrinter").val() + "is not avalable")

            }

            const  tex= await response.text()
            console.log(tex)
            $("#logDiv").html(tex.replace(/\n/g, '<br>'))
        } catch (error) {
            console.error('Fetch error:', error);
        }

    }

    async function status() {
        let printer = $("#selectPrinter4").val()

        try {
            const url = `/status?printer=${printer}`;
            const response = await fetch(url);
            console.log(response)
            if (!response.ok) {

                $("#printerStatus").html("Printer" + $("#selectPrinter4").val() + "is not avalable")

            }
            const  tex= await response.text()
            console.log(tex)
            $("#logDiv").html(tex.replace(/\n/g, '<br>'))

        } catch (error) {
            console.error('Fetch error:', error);
        }
    }

    async function setConf() {
        let parameter = $("#parset").val()
        let value = $("#confset").val()

        try {
            const url = `/setConf?parameter=${parameter}&value=${value}`;
            const response = await fetch(url);
            console.log(response)
            if (!response.ok) {

                $("#setConf").html(response.json())

            }
            const  tex= await response.text()
            console.log(tex)
            $("#logDiv").html(tex.replace(/\n/g, '<br>'))

        } catch (error) {
            console.error('Fetch error:', error);
        }
    }

    async function getConf() {
        let parameter = $("#parset2").val()

        try {
            const url = `/getConf?parameter=${parameter}`;
            const response = await fetch(url);
            console.log(response)
            if (!response.ok) {

                $("#getConf").html(response.json())

            }
            const  tex= await response.text()
            console.log(tex)
            $("#logDiv").html(tex.replace(/\n/g, '<br>'))

        } catch (error) {
            console.error('Fetch error:', error);
        }
    }



    function  logOut(){
        window.location.href="/logout"
    }
</script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
        }
        .custom-heading {
            color: #007BFF;
            font-size: x-large;

        }
        #logDiv{
            background: black;
            border-color: green;
            font-size: larger;
            color: green;
            width: fit-content;
            margin-top: 20px;
            border: double;
            width: 542px;
        }
        .custom-text {
            color: #333;
        }
        .custom-button {
            background-color: #28A745;
            color: #FFF;
        }
        .containerDiv{
            position: relative;
            display: inline-flex;

            flex-direction: row-reverse;
            left: -634px;
        }
        .mt-3{
            width: 300px;
        }
        .logged{
            font-size: larger;
            align-items: center;
            display: flex;
            align-content: center;
            flex-direction: column;
            font-weight: 700;
        }
    </style>
</head>
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body class="bg-light">
<div class="logged">

    <p>You are logged-in</p>
    <button  class="btn btn-dark" style="margin: 20px" onclick="logOut()">Log-out</button>

</div>
<div class="container">

    <div class="row justify-content-center mt-5">
        <div class="col-md-6">
            <h1 class="text-center " style="color: #007BFF">Printing Service</h1>
            <br/>
            <hr>

            <div class="card">
                <div class="card-body" style="text-align: center">
                    <h2 class="custom-text">Server Status</h2>
                    <h5 style="color: #28A745" class="mb-0 custom-text" th:if="${status=='start'}">Server is started</h5>
                    <h5 style="color: red" class="mb-0 custom-text" th:if="${status=='stop'}">Server is stopped</h5>
                    <br/>
                    <button th:if="${status=='stop'}" class="btn btn-success" onclick="startServer()">Start Server</button>
                    <button th:if="${status=='start'}" class="btn btn-danger" onclick="stopServer()">Stop Server</button>
                    <button th:if="${status=='start'}" class="btn btn-dark" onclick="restartServer()">Restart Server</button>

                </div>
            </div>


            <div class="containerDiv">
                <div th:if="${status=='start'}" class="card mt-3">
                    <div class="card-body">
                        <h1 class="mt-3 custom-heading">Print File</h1>

                        <div class="form-group">
                            <label for="fileName" class="custom-text">File Name</label>
                            <input type="text" class="form-control" id="fileName" placeholder="Insert file name here" required>
                        </div>

                        <div class="form-group">
                            <label for="selectPrinter" class="custom-text">Select Printer</label>
                            <select class="form-control" id="selectPrinter">
                                <option value="Printer1">Printer 1</option>
                                <option value="Printer2">Printer 2</option>
                                <option value="Printer3">Printer 3</option>
                            </select>
                        </div>

                        <button class="btn btn-dark" onclick="print()">Print</button>
                        <h5 id="printStatus" class="mt-3 custom-text"></h5>
                    </div>
                </div>




                <div th:if="${status=='start'}" class="card mt-3">
                    <div class="card-body">
                        <h1 class="mt-3 custom-heading">Queue Printer</h1>

                        <div class="form-group">
                            <label for="selectPrinter" class="custom-text">Select Printer</label>
                            <select class="form-control" id="selectPrinter2">
                                <option value="Printer1">Printer 1</option>
                                <option value="Printer2">Printer 2</option>
                                <option value="Printer3">Printer 3</option>
                            </select>
                        </div>

                        <button class="btn btn-dark " onclick="queue()">Queue</button>
                        <h5 id="queuePrinter" class="mt-3 custom-text"></h5>
                    </div>
                </div>




                <div th:if="${status=='start'}" class="card mt-3">
                    <div class="card-body">
                        <h1 class="mt-3 custom-heading">top Queue</h1>

                        <div class="form-group">
                            <label for="selectPrinter" class="custom-text">Select Printer</label>
                            <select class="form-control" id="selectPrinter3">
                                <option value="Printer1">Printer 1</option>
                                <option value="Printer2">Printer 2</option>
                                <option value="Printer3">Printer 3</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="fileName" class="custom-text">Job id</label>
                            <input type="text" class="form-control" id="jobid" placeholder="Insert job id" required>
                        </div>

                        <button class="btn btn-dark" onclick="topQueue()">Top Queue</button>
                        <h5 id="topqueue" class="mt-3 custom-text"></h5>
                    </div>
                </div>



                <div th:if="${status=='start'}" class="card mt-3">
                    <div class="card-body">
                        <h1 class="mt-3 custom-heading">Get Printer status</h1>

                        <div class="form-group">
                            <label for="selectPrinter" class="custom-text">Select Printer</label>
                            <select class="form-control" id="selectPrinter4">
                                <option value="Printer1">Printer 1</option>
                                <option value="Printer2">Printer 2</option>
                                <option value="Printer3">Printer 3</option>
                            </select>
                        </div>

                        <button class="btn btn-dark " onclick="status()">get status</button>
                        <h5 id="printerStatus" class="mt-3 custom-text"></h5>
                    </div>
                </div>



                <div th:if="${status=='start'}" class="card mt-3">
                    <div class="card-body">
                        <h1 class="mt-3 custom-heading">Set configuration</h1>
                        <div class="form-group">
                            <label for="fileName" class="custom-text">Parameter Name</label>
                            <input type="text" class="form-control" id="parset" placeholder="Insert Parameter" required>
                        </div>
                        <div class="form-group">
                            <label for="fileName" class="custom-text">configuration</label>
                            <input type="text" class="form-control" id="confset" placeholder="Insert configuration" required>
                        </div>
                        <button class="btn btn-dark " onclick="setConf()">Set</button>

                        <h5 id="setConf" class="mt-3 custom-text"></h5>

                    </div>
                </div>



                <div th:if="${status=='start'}" class="card mt-3">
                    <div class="card-body">
                        <h1 class="mt-3 custom-heading">Read configuration</h1>
                        <div class="form-group">
                            <label for="fileName" class="custom-text">Parameter Name</label>
                            <input type="text" class="form-control" id="parset2" placeholder="Insert Parameter" required>
                        </div>

                        <button class="btn btn-dark " onclick="getConf()">Get</button>

                        <h5 id="getConf" class="mt-3 custom-text"></h5>

                    </div>
                </div>
            </div>
            <div id="logDiv">

            </div>
        </div>
    </div>
</div>
</body>
</html>
